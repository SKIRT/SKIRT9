/*//////////////////////////////////////////////////////////////////
////     The SKIRT project -- advanced radiative transfer       ////
////       Â© Astronomical Observatory, Ghent University         ////
///////////////////////////////////////////////////////////////// */

#include "CylindricalClipGeometryDecorator.hpp"

////////////////////////////////////////////////////////////////////

int CylindricalClipGeometryDecorator::dimension() const
{
    return max(geometry()->dimension(), 2);
}

////////////////////////////////////////////////////////////////////

bool CylindricalClipGeometryDecorator::inside(Position bfr) const
{
    return bfr.cylRadius() <= _clipRadius;
}

////////////////////////////////////////////////////////////////////

double CylindricalClipGeometryDecorator::SigmaX() const
{
    return geometry()->SigmaX() * norm();
}

////////////////////////////////////////////////////////////////////

double CylindricalClipGeometryDecorator::SigmaY() const
{
    return geometry()->SigmaY() * norm();
}

////////////////////////////////////////////////////////////////////

double CylindricalClipGeometryDecorator::SigmaZ() const
{
    if (remove() == Remove::Inside)
        return 0.0;
    else
        return geometry()->SigmaZ();
}

////////////////////////////////////////////////////////////////////
